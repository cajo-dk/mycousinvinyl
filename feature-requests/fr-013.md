# Feature Request

- REQUEST ID: FR-013
- DATE: 2026.01.09

## Abstract

Add per-user, per-album play counts with last-played tracking. Provide a +1 control on Collection page albums and a paged “Played This Year” list on the Home (stats) page.

## Scope

- Backend: store and update per-user, per-album play counts and last-played timestamps.
- API: expose endpoints to increment plays and list YTD plays.
- Frontend: Collection page +1 button; Home page “Played This Year” list with pagination.
- Access: available to all authenticated users; user-scoped data only.

## Requirements

### Play Counts (per album, per user)

- Play counts are stored at the album level (not per pressing).
- Each +1 action increments the user’s play count for that album by 1.
- Each +1 action updates `last_played_at` to current timestamp (overall, not just YTD).

### Collection Page

- For each album listing in the user’s Collection view, add a “+1” icon button.
- Clicking +1 updates the user’s album play count and last-played timestamp.
- UI should update in-place without resetting the current view.

### Home Page: “Played This Year”

- Add a new section at the bottom: `PLAYED THIS YEAR`.
- Show only albums where YTD play count > 0.
- Sort descending by YTD play count, then by `last_played_at` descending.
- List columns:
  - `#` (1..n)
  - `Number of times played YTD`
  - `Artist`
  - `Album`
  - `Last played` (overall)
- Unlimited length, with pagination (default page size = 50).
- Provide pagination controls and allow page size changes if consistent with other list UIs.

### API

- Endpoint to increment play count for a user+album.
- Endpoint to list YTD plays for a user with pagination:
  - Parameters: `year` (default current year), `limit` (default 50), `offset`.
  - Response includes total count and per-album entries with:
    - `album_id`, `album_title`, `artist_id`, `artist_name`
    - `play_count_ytd`
    - `last_played_at` (overall)

### Security

- All operations are user-scoped at the HTTP entrypoints.
- Domain/application layers remain security-agnostic.

## Acceptance Criteria

- +1 button increments play count and updates last-played for the signed-in user’s album without resetting the Collection view.
- Home page shows “PLAYED THIS YEAR” list with albums having YTD play_count > 0.
- List is ordered by YTD play count descending, then `last_played_at` descending, and supports pagination (default 50).
- Last-played displays the overall last-played timestamp for each album.
- All data is scoped to the authenticated user.
